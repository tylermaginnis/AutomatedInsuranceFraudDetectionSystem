@model dynamic
@{
    ViewData["Title"] = "Home Page";
}

<div class="text-center">
    <h1 class="display-4">Key Metrics</h1>
    <p>Total Number of Claims: @Model.TotalClaims</p>
</div>

<div id="menu" class="text-center">
    <h2>Visualizations Menu</h2>
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-car-crash fa-3x"></i>
                    <p class="card-text">Claims by Coverage Type</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-user fa-3x"></i>
                    <p class="card-text">Claims by Policy Holder</p>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-user-tie fa-3x"></i>
                    <p class="card-text">Claims by Adjuster</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-calendar-alt fa-3x"></i>
                    <p class="card-text">Claims Over Time</p>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-tasks fa-3x"></i>
                    <p class="card-text">Claims by Status Over Time</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-chart-bar fa-3x"></i>
                    <p class="card-text">Average Claimed and Approved Amounts by Coverage Type</p>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-map-marker-alt fa-3x"></i>
                    <p class="card-text">Claims by State</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-calendar-check fa-3x"></i>
                    <p class="card-text">Claims by Policy Effective Dates</p>
                </div>
            </div>
        </div>
    </div>
    <br /><br />
    <h2>Fraud Visualizations Menu</h2>
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-exclamation-triangle fa-3x"></i>
                    <p class="card-text">Fraud Likelihood</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-chart-line fa-3x"></i>
                    <p class="card-text">Fraud Scores</p>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-user-secret fa-3x"></i>
                    <p class="card-text">Claims by Fraud Likelihood</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-balance-scale fa-3x"></i>
                    <p class="card-text">Fraud Score Distribution</p>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-user-check fa-3x"></i>
                    <p class="card-text">Claims by Adjuster Fraud Likelihood</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-calendar-day fa-3x"></i>
                    <p class="card-text">Fraud Likelihood Over Time</p>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-user-clock fa-3x"></i>
                    <p class="card-text">Claims by Policy Holder Fraud Likelihood</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-chart-pie fa-3x"></i>
                    <p class="card-text">Fraud Score by Coverage Type</p>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="visualizations" style="display:none;">
    <div class="text-left">
        <i class="fas fa-arrow-left fa-2x" id="backButton" style="cursor:pointer;"></i>
    </div>
    <div id="visualizationContent">
        <div id="claimsByCoverageType" style="display:none;">
            <h3>Claims by Coverage Type</h3>
            <canvas id="claimsByCoverageChart"></canvas>
        </div>
        <div id="claimsByPolicyHolder" style="display:none;">
            <h3>Claims by Policy Holder</h3>
            <canvas id="claimsByPolicyHolderChart"></canvas>
        </div>
        <div id="claimsByAdjuster" style="display:none;">
            <h3>Claims by Adjuster</h3>
            <canvas id="claimsByAdjusterChart"></canvas>
        </div>
        <div id="claimsOverTime" style="display:none;">
            <h3>Claims Over Time</h3>
            <canvas id="claimsOverTimeChart"></canvas>
        </div>
        <div id="claimsByStatusOverTime" style="display:none;">
            <h3>Claims by Status Over Time</h3>
            <canvas id="claimsByStatusOverTimeChart"></canvas>
        </div>
        <div id="averageAmountsByCoverageType" style="display:none;">
            <h3>Average Claimed and Approved Amounts by Coverage Type</h3>
            <canvas id="averageAmountsByCoverageChart"></canvas>
        </div>
        <div id="claimsByState" style="display:none;">
            <h3>Claims by State</h3>
            <canvas id="claimsByStateChart"></canvas>
        </div>
        <div id="claimsByPolicyEffectiveDates" style="display:none;">
            <h3>Claims by Policy Effective Dates</h3>
            <canvas id="claimsByPolicyEffectiveDatesChart"></canvas>
        </div>
        <div id="fraudLikelihood" style="display:none;">
            <h3>Fraud Likelihood</h3>
            <canvas id="fraudLikelihoodChart"></canvas>
        </div>
        <div id="fraudScores" style="display:none;">
            <h3>Fraud Scores</h3>
            <canvas id="fraudScoresChart"></canvas>
        </div>
        <div id="claimTotalsByFraudLikelihood" style="display:none;">
            <h3>Claims Totals by Fraud Likelihood</h3>
            <canvas id="claimTotalsByFraudLikelihoodChart"></canvas>
        </div>
        <div id="fraudScoreDistribution" style="display:none;">
            <h3>Fraud Score Distribution</h3>
            <canvas id="fraudScoreDistributionChart"></canvas>
        </div>
        <div id="claimsByAdjusterFraudLikelihood" style="display:none;">
            <h3>Claims by Adjuster Fraud Likelihood</h3>
            <canvas id="claimsByAdjusterFraudLikelihoodChart"></canvas>
        </div>
        <div id="fraudLikelihoodOverTime" style="display:none;">
            <h3>Fraud Likelihood Over Time</h3>
            <canvas id="fraudLikelihoodOverTimeChart"></canvas>
        </div>
        <div id="claimsByPolicyHolderFraudLikelihood" style="display:none;">
            <h3>Claims by Policy Holder Fraud Likelihood</h3>
            <canvas id="claimsByPolicyHolderFraudLikelihoodChart"></canvas>
        </div>
        <div id="fraudScoreByCoverageType" style="display:none;">
            <h3>Fraud Score by Coverage Type</h3>
            <canvas id="fraudScoreByCoverageTypeChart"></canvas>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <script>
        var claimsByCoverageType = @Html.Raw(ViewBag.ClaimsByCoverageTypeJson);
        var claimsByPolicyHolder = @Html.Raw(ViewBag.ClaimsByPolicyHolderJson);
        var claimsByAdjuster = @Html.Raw(ViewBag.ClaimsByAdjusterJson);
        var claimsOverTime = @Html.Raw(ViewBag.ClaimsOverTimeJson);
        var claimsByStatusOverTime = @Html.Raw(ViewBag.ClaimsByStatusOverTimeJson);
        var averageAmountsByCoverageType = @Html.Raw(ViewBag.AverageAmountsByCoverageTypeJson);
        var claimsByState = @Html.Raw(ViewBag.ClaimsByStateJson);
        var claimsByPolicyEffectiveDates = @Html.Raw(ViewBag.ClaimsByPolicyEffectiveDatesJson);
        var fraudLikelihood = @Html.Raw(ViewBag.ClaimsByFraudLikelihoodJson);
        var fraudScores = @Html.Raw(ViewBag.FraudScoresJson);
        var claimTotalsByFraudLikelihood = @Html.Raw(ViewBag.ClaimTotalsByFraudLikelihoodJson);
        var fraudScoreDistribution = @Html.Raw(ViewBag.FraudScoreDistributionJson);
        var claimsByAdjusterFraudLikelihood = @Html.Raw(ViewBag.ClaimsByAdjusterFraudLikelihoodJson);
        var fraudLikelihoodOverTime = @Html.Raw(ViewBag.FraudLikelihoodOverTimeJson);
        var claimsByPolicyHolderFraudLikelihood = @Html.Raw(ViewBag.ClaimsByPolicyHolderFraudLikelihoodJson);
        var fraudScoreByCoverageType = @Html.Raw(ViewBag.FraudScoreByCoverageTypeJson);

        var claimsByCoverageTypeData = {
            labels: claimsByCoverageType.map(c => c.CoverageType),
            datasets: [{
                label: 'Total Claimed Amount',
                data: claimsByCoverageType.map(c => c.TotalClaimedAmount),
                backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
            }]
        };

        var claimsByCoverageTypeCtx = document.getElementById('claimsByCoverageChart').getContext('2d');
        new Chart(claimsByCoverageTypeCtx, {
            type: 'bar',
            data: claimsByCoverageTypeData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Claims by Coverage Type'
                }
            }
        });

        var claimsByPolicyHolderData = {
            labels: claimsByPolicyHolder.map(p => p.PolicyHolder), // Ensure this is a string
            datasets: [{
                label: 'Total Amount Claimed by Policy Holder',
                data: claimsByPolicyHolder.map(p => p.TotalClaimedAmount),
                backgroundColor: '#FF6384'
            }, {
                label: 'Total Amount Approved by Policy Holder',
                data: claimsByPolicyHolder.map(p => p.TotalApprovedAmount),
                backgroundColor: '#36A2EB'
            }]
        };

        var claimsByPolicyHolderCtx = document.getElementById('claimsByPolicyHolderChart').getContext('2d');
        new Chart(claimsByPolicyHolderCtx, {
            type: 'bar',
            data: claimsByPolicyHolderData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Claims by Policy Holder'
                }
            }
        });

        var claimsByAdjusterData = {
            labels: claimsByAdjuster.map(a => a.Adjuster),
            datasets: [{
                label: 'Total Amount Claimed by Adjuster',
                data: claimsByAdjuster.map(a => a.TotalClaimedAmount),
                backgroundColor: '#FF6384'
            }, {
                label: 'Total Amount Approved by Adjuster',
                data: claimsByAdjuster.map(a => a.TotalApprovedAmount),
                backgroundColor: '#36A2EB'
            }]
        };

        var claimsByAdjusterCtx = document.getElementById('claimsByAdjusterChart').getContext('2d');
        new Chart(claimsByAdjusterCtx, {
            type: 'bar',
            data: claimsByAdjusterData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Claims by Adjuster'
                }
            }
        });

        var claimsOverTimeData = {
            labels: claimsOverTime.map(c => new Date(c.Date).toLocaleString('default', { month: 'long', year: 'numeric' })),
            datasets: [{
                label: 'Number of Claims',
                data: claimsOverTime.map(c => c.ClaimCount),
                backgroundColor: '#36A2EB'
            }]
        };

        var claimsOverTimeCtx = document.getElementById('claimsOverTimeChart').getContext('2d');
        new Chart(claimsOverTimeCtx, {
            type: 'line',
            data: claimsOverTimeData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Claims Over Time by Month'
                },
                scales: {
                    xAxes: [{
                        type: 'time',
                        time: {
                            unit: 'month',
                            tooltipFormat: 'MMM YYYY',
                            displayFormats: {
                                month: 'MMM YYYY'
                            }
                        }
                    }]
                }
            }
        });

        var claimsByStatusOverTime = @Html.Raw(ViewBag.ClaimsByStatusOverTimeJson);

        var statusColors = {
            'Closed': '#FF6384',
            'Filed': '#36A2EB',
            'In Review': '#FFCE56',
            'Approved': '#4BC0C0'
        };

        var groupedData = claimsByStatusOverTime.reduce((acc, curr) => {
            var date = new Date(curr.Date).toLocaleString('default', { month: 'long', year: 'numeric' });
            if (!acc[date]) acc[date] = {};
            acc[date][curr.ClaimStatus] = curr.ClaimCount;
            return acc;
        }, {});

        var labels = Object.keys(groupedData);
        var datasets = Object.keys(statusColors).map(status => ({
            label: status,
            data: labels.map(label => groupedData[label][status] || 0),
            backgroundColor: statusColors[status]
        }));

        var claimsByStatusOverTimeData = {
            labels: labels,
            datasets: datasets
        };

        var claimsByStatusOverTimeCtx = document.getElementById('claimsByStatusOverTimeChart').getContext('2d');
        new Chart(claimsByStatusOverTimeCtx, {
            type: 'bar',
            data: claimsByStatusOverTimeData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Claims by Status Over Time'
                },
                scales: {
                    xAxes: [{
                        type: 'time',
                        time: {
                            unit: 'month',
                            tooltipFormat: 'MMM YYYY',
                            displayFormats: {
                                month: 'MMM YYYY'
                            }
                        }
                    }]
                }
            }
        });

        var averageAmountsByCoverageType = @Html.Raw(ViewBag.AverageAmountsByCoverageTypeJson);

        var coverageTypes = ["BIL", "PDL", "PIP", "CollisionCoverage", "ComprehensiveCoverage"];
        var averageAmountsByCoverageTypeData = {
            labels: coverageTypes,
            datasets: [{
                label: 'Average Claimed Amount',
                data: coverageTypes.map(type => {
                    var coverage = averageAmountsByCoverageType.find(c => c.Coverage === type);
                    return coverage ? coverage.AverageClaimedAmount : 0;
                }),
                backgroundColor: '#36A2EB'
            }, {
                label: 'Average Approved Amount',
                data: coverageTypes.map(type => {
                    var coverage = averageAmountsByCoverageType.find(c => c.Coverage === type);
                    return coverage ? coverage.AverageApprovedAmount : 0;
                }),
                backgroundColor: '#FF6384'
            }]
        };

        var averageAmountsByCoverageTypeCtx = document.getElementById('averageAmountsByCoverageChart').getContext('2d');
        new Chart(averageAmountsByCoverageTypeCtx, {
            type: 'bar',
            data: averageAmountsByCoverageTypeData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Average Claimed and Approved Amounts by Coverage Type'
                },
                scales: {
                    xAxes: [{
                        stacked: true
                    }],
                    yAxes: [{
                        stacked: true
                    }]
                }
            }
        });

        var claimsByStateData = {
            labels: claimsByState.map(s => s.State),
            datasets: [{
                label: 'Number of Claims',
                data: claimsByState.map(s => s.ClaimCount),
                backgroundColor: '#36A2EB'
            }]
        };

        var claimsByStateCtx = document.getElementById('claimsByStateChart').getContext('2d');
        new Chart(claimsByStateCtx, {
            type: 'bar',
            data: claimsByStateData
        });
        
        var claimsByPolicyEffectiveDatesData = {
            labels: claimsByPolicyEffectiveDates.map(p => new Date(p.Date).toLocaleString('default', { month: 'long', year: 'numeric' })),
            datasets: [{
                label: 'Number of Policies',
                data: claimsByPolicyEffectiveDates.map(p => p.ClaimCount),
                backgroundColor: '#36A2EB'
            }]
        };

        var claimsByPolicyEffectiveDatesCtx = document.getElementById('claimsByPolicyEffectiveDatesChart').getContext('2d');
        new Chart(claimsByPolicyEffectiveDatesCtx, {
            type: 'bar',
            data: claimsByPolicyEffectiveDatesData
        });


        var fraudLikelihoodData = {
            labels: fraudLikelihood.map(f => f.FraudLikelihood),
            datasets: [{
                label: 'Number of Claims',
                data: fraudLikelihood.map(f => f.ClaimCount), // Ensure this matches the property name in the controller
                backgroundColor: '#FF6384'
            }]
        };

        var fraudLikelihoodCtx = document.getElementById('fraudLikelihoodChart').getContext('2d');
        new Chart(fraudLikelihoodCtx, {
            type: 'bar',
            data: fraudLikelihoodData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Fraud Likelihood'
                }
            }
        });

        var fraudScoresData = {
            labels: fraudScores.map(f => f.ClaimID),
            datasets: [{
                label: 'Fraud Scores',
                data: fraudScores.map(f => f.FraudScore),
                backgroundColor: '#36A2EB'
            }]
        };

        var fraudScoresCtx = document.getElementById('fraudScoresChart').getContext('2d');
        new Chart(fraudScoresCtx, {
            type: 'line',
            data: fraudScoresData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Fraud Scores'
                }
            }
        });

        // Claim Totals by Fraud Likelihood Chart
        var claimTotalsByFraudLikelihood = @Html.Raw(ViewBag.ClaimTotalsByFraudLikelihoodJson);

        var claimTotalsByFraudLikelihoodData = {
            labels: claimTotalsByFraudLikelihood.map(f => f.FraudLikelihood),
            datasets: [{
                label: 'Total Claimed Amount',
                data: claimTotalsByFraudLikelihood.map(f => f.TotalClaimedAmount),
                backgroundColor: '#36A2EB'
            }]
        };

        var claimTotalsByFraudLikelihoodCtx = document.getElementById('claimTotalsByFraudLikelihoodChart').getContext('2d');
        new Chart(claimTotalsByFraudLikelihoodCtx, {
            type: 'bar',
            data: claimTotalsByFraudLikelihoodData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Claim Totals by Fraud Likelihood'
                }
            }
        });

        var fraudScoreDistribution = @Html.Raw(ViewBag.FraudScoreDistributionJson);

        var fraudScoreDistributionData = {
            labels: fraudScoreDistribution.map(f => f.ScoreRange),
            datasets: [{
                label: 'Fraud Score Distribution',
                data: fraudScoreDistribution.map(f => f.ClaimCount), // Corrected property name
                backgroundColor: '#36A2EB'
            }]
        };

        var fraudScoreDistributionCtx = document.getElementById('fraudScoreDistributionChart').getContext('2d');
        new Chart(fraudScoreDistributionCtx, {
            type: 'bar',
            data: fraudScoreDistributionData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Fraud Score Distribution'
                },
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true,
                            min: 0,
                            max: Math.max(...fraudScoreDistribution.map(f => f.ClaimCount)) + 10 // Adjust max value based on data
                        }
                    }]
                }
            }
        });


        var claimsByAdjusterFraudLikelihood = @Html.Raw(ViewBag.ClaimsByAdjusterFraudLikelihoodJson);

        // Debugging: Log the data to ensure it's correct
        //console.log(claimsByAdjusterFraudLikelihood);

        var adjusters = [...new Set(claimsByAdjusterFraudLikelihood.map(f => f.Adjuster))];
        var fraudLikelihoods = [...new Set(claimsByAdjusterFraudLikelihood.map(f => f.FraudLikelihood))];

        var datasets = fraudLikelihoods.map(fraudLikelihood => ({
            label: fraudLikelihood,
            data: adjusters.map(adjuster => {
                var item = claimsByAdjusterFraudLikelihood.find(f => f.Adjuster === adjuster && f.FraudLikelihood === fraudLikelihood);
                return item ? item.Count : 0;
            }),
            backgroundColor: fraudLikelihood === 'high' ? '#FF6384' : '#36A2EB'
        }));

        var claimsByAdjusterFraudLikelihoodData = {
            labels: adjusters,
            datasets: datasets
        };

        // Debugging: Log the datasets to ensure they are correct
        //console.log(claimsByAdjusterFraudLikelihoodData);

        // Calculate maxCount based on the Count values
        var maxCount = Math.max(...claimsByAdjusterFraudLikelihood.map(f => parseInt(f.Count)));

        console.log(maxCount);

        var claimsByAdjusterFraudLikelihoodCtx = document.getElementById('claimsByAdjusterFraudLikelihoodChart').getContext('2d');
        new Chart(claimsByAdjusterFraudLikelihoodCtx, {
            type: 'bar',
            data: claimsByAdjusterFraudLikelihoodData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Claims by Adjuster Fraud Likelihood'
                },
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true,
                            min: 0,
                            max: maxCount + 5 // Adjust max value based on data
                        }
                    }]
                }
            }
        });

        var fraudLikelihoodOverTimeData = {
            labels: fraudLikelihoodOverTime.map(f => new Date(f.Date).toLocaleString('default', { month: 'long', year: 'numeric' })),
            datasets: [{
                label: 'Fraud Likelihood',
                data: fraudLikelihoodOverTime.map(f => f.FraudLikelihood),
                backgroundColor: '#36A2EB'
            }]
        };

        var fraudLikelihoodOverTimeCtx = document.getElementById('fraudLikelihoodOverTimeChart').getContext('2d');
        new Chart(fraudLikelihoodOverTimeCtx, {
            type: 'line',
            data: fraudLikelihoodOverTimeData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Fraud Likelihood Over Time'
                }
            }
        });

        var claimsByPolicyHolderFraudLikelihoodData = {
            labels: claimsByPolicyHolderFraudLikelihood.map(f => f.PolicyHolder),
            datasets: [{
                label: 'Fraud Likelihood',
                data: claimsByPolicyHolderFraudLikelihood.map(f => f.FraudLikelihood),
                backgroundColor: '#FF6384'
            }]
        };

        var claimsByPolicyHolderFraudLikelihoodCtx = document.getElementById('claimsByPolicyHolderFraudLikelihoodChart').getContext('2d');
        new Chart(claimsByPolicyHolderFraudLikelihoodCtx, {
            type: 'bar',
            data: claimsByPolicyHolderFraudLikelihoodData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Claims by Policy Holder Fraud Likelihood'
                }
            }
        });

        var fraudScoreByCoverageTypeData = {
            labels: fraudScoreByCoverageType.map(f => f.CoverageType),
            datasets: [{
                label: 'Fraud Score',
                data: fraudScoreByCoverageType.map(f => f.FraudScore),
                backgroundColor: '#36A2EB'
            }]
        };

        var fraudScoreByCoverageTypeCtx = document.getElementById('fraudScoreByCoverageTypeChart').getContext('2d');
        new Chart(fraudScoreByCoverageTypeCtx, {
            type: 'pie',
            data: fraudScoreByCoverageTypeData,
            options: {
                responsive: true,
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Fraud Score by Coverage Type'
                }
            }
        });

        document.querySelectorAll('#menu .col').forEach((col, index) => {
            col.addEventListener('click', function() {
                document.getElementById('menu').style.display = 'none';
                document.getElementById('visualizations').style.display = 'block';
                document.querySelectorAll('#visualizationContent > div').forEach(div => div.style.display = 'none');
                document.querySelectorAll('#visualizationContent > div')[index].style.display = 'block';
                // Remove the height change to avoid vertical animation
                // document.getElementById('visualizations').style.height = '100vh';
            });
        });

        document.getElementById('backButton').addEventListener('click', function() {
            document.getElementById('menu').style.display = 'block';
            document.getElementById('visualizations').style.display = 'none';
            // Remove the height change to avoid vertical animation
            // document.getElementById('visualizations').style.height = '0';
        });
    </script>
}
